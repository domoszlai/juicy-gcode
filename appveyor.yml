image:
  - Visual Studio 2015
  - Ubuntu
  - macos

version: '{build}'
platform: x64
cache:
  - c:\s

install:
  - cmd: set STACK_ROOT=c:\s
  - cmd: set PATH=C:\Program Files\Git\mingw64\bin;%PATH%
  - cmd: curl -sS -o stack.zip -L --insecure https://get.haskellstack.org/stable/windows-x86_64.zip
  - cmd: 7z x stack.zip stack.exe
  - sh: curl -sSL https://get.haskellstack.org/ | sh
build_script:
  - cmd: stack.exe setup
  - cmd: stack.exe --no-terminal build --only-dependencies
  - sh: stack setup
  - sh: stack build
test_script:
  - cmd: stack.exe --no-terminal build --pedantic
  - cmd: stack.exe sdist
  - sh: stack build
  - sh: stack sdist
